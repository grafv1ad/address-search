!function(){var e={237:function(){const e=document.querySelector(".search__input-wrapper"),t=e.querySelector("#search"),a=document.querySelector(".history__list"),n=document.querySelector(".search__suggest"),o=document.querySelector(".result"),r=o.querySelector(".result__table"),s=o.querySelector(".result__map"),l=document.querySelector(".settings"),c=()=>n.innerHTML="",i=()=>o.classList.remove("result_active"),u=function(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.classList.add("search__input-wrapper_loading"),a&&(t.disabled=!0)},d=()=>{e.classList.remove("search__input-wrapper_loading"),t.disabled=!1},p=e=>{if(a.innerHTML="",!e){const t=window.localStorage.getItem("search-history");if(!t)return;e=t}JSON.parse(e).forEach((e=>{const t=document.createElement("div");t.classList.add("sidebar__block-item"),t.textContent=e,t.setAttribute("onclick","window.showResult(this.textContent);"),a.append(t)}))};p();const g=()=>{const e=l.querySelector('input[name="language"]:checked');return e?.value||"en"},m={method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Token 89147d67ecec30829c71feb6b8ebc352a7dd4e7a"},count:10,get body(){return JSON.stringify({query:t.value,count:this.count,language:g(),locations:{country:"*"}})}},h=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;const t=m;t.count=e;try{const e=await fetch("https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address",t);return e.ok?e.json():void console.error("Сетевая ошибка, попробуйте обновить страницу")}catch(e){return void console.error("Что-то пошло не так, попробуйте обновить страницу")}};window.showResult=async e=>{t.value=e,c(),u(!0);const a=await(async e=>{try{const e=await h(1);return e.suggestions&&e.suggestions[0]?(e.suggestions[0],e.suggestions[0]):void console.error("Ошибка, не получилось получить данные")}catch(e){return void console.error(e)}})();r.innerHTML="";const n=a.data.geo_lat&&a.data.geo_lon?`${a.data.geo_lat}, ${a.data.geo_lon}`:null;let l=a.data.fias_id,i="ФИАС";l&&(/^\d+$/.test(l)?(l=`<a href="https://www.geonames.org/${l}/" target="_blank">${l}</a>`,i="GeoNames"):/^relation:\d+$/.test(l)?(l=`<a href="https://www.openstreetmap.org/${l.replace(":","/")}/" target="_blank">${l}</a>`,i="OpenStreetMap"):l=`<a href="http://basicdata.ru/online/fias/${l}/" target="_blank">${l}</a>`);const g=[{name:"Полный адрес",value:a.unrestricted_value},{name:"Координаты",value:n?`<a href="https://yandex.ru/maps/?text=${a.data.geo_lat}%2C${a.data.geo_lon}" target="_blank">${n}</a>`:null},{name:"Индекс",value:a.data.postal_code},{name:"Страна",value:a.data.country},{name:"ISO код страны",value:a.data.country_iso_code},{name:"Федеральный округ",value:a.data.federal_district},{name:"Регион",value:a.data.region_with_type},{name:"ISO код региона",value:a.data.region_iso_code},{name:"Город",value:a.data.city},{name:"Улица",value:a.data.street},{name:"Земельный участок",value:a.data.stead},{name:"Дом",value:a.data.house},{name:"Квартира",value:a.data.flat},{name:i,value:l},{name:"КЛАДР",value:a.data.kladr_id},{name:"ОКАТО",value:a.data.okato},{name:"ОКТМО",value:a.data.oktmo},{name:"ИФНС",value:a.data.tax_office}];a.data.geo_lat&&a.data.geo_lon&&(g.cords=`${a.data.geo_lat}, ${a.data.geo_lon}`),g.forEach((e=>{if(!e.value)return;const t=document.createElement("div"),a=document.createElement("div");t.textContent=e.name,a.innerHTML=e.value,r.append(t),r.append(a)})),n?(e=>{window.resultMap.setCenter(e.split(", "),14,{checkZoomRange:!0}),s.classList.add("result__map_active")})(n):s.classList.remove("result__map_active"),(e=>{if(!e)return;const t=window.localStorage.getItem("search-history");let a=[e];if(t){let n=JSON.parse(t);if(n.includes(e))return;n.push(e),n.length>10&&(n=n.slice(1)),a=n}a=JSON.stringify(a),window.localStorage.setItem("search-history",a),p(a)})(a.value),o.classList.add("result_active"),d()};const v=(_=async()=>{i(),u(),(await(async()=>{c();try{const e=(await h()).suggestions;if(!e)return void console.error("Ошибка, не получилось получить данные");if(!e.length)return void console.error("Не удалось ничего найти");const t=[];for(const a in e)t.push(e[a].value);return t}catch(e){return void console.error(e)}})()).forEach((e=>{const t=document.createElement("div");t.classList.add("search__suggest-item"),t.textContent=e,t.setAttribute("onclick","window.showResult(this.textContent);"),n.append(t)})),d()},1e3,function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];let n=this.lastCall;this.lastCall=Date.now(),n&&this.lastCall-n<=1e3&&clearTimeout(this.lastCallTimer),this.lastCallTimer=setTimeout((()=>_(...t)),1e3)});var _;const f=()=>{d(),c(),i(),v()};t.addEventListener("input",(()=>f())),t.addEventListener("keyup",(e=>{"Enter"===e.key&&f()})),window.addEventListener("storage",(e=>{console.debug(e),"search-history"===e.key&&p(e.newValue)})),ymaps.ready((()=>{window.resultMap=new ymaps.Map("result-map",{center:["55.608475","-27.669462"],zoom:2,controls:["zoomControl"]},{suppressMapOpenBlock:!0})}))}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";a(237)}()}();
//# sourceMappingURL=main.6ee8b5b7462ed2b0f1ae.js.map